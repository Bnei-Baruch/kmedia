- title "Admin/Catalogs"

%p
  = link_to_if can?(:create, Catalog), "New Catalog", new_admin_catalog_path do
    .unable New Catalog
= paginate @catalogs
%br
%table.admin_table.bp
  %tr
    %th Catalog
    %th Created
    %th Updated
    %th Secure
    %th(colspan=3) Actions
  - @catalogs.each do |catalog|
    %tr(class="#{cycle('odd', 'even')}")
      %td
        - if catalog.parent
          %span.small
            = catalog.parent.catalognodename.gsub(/\//, ' / ')
            (
            = catalog.parentnodeid
            ) /
        %span.bold
          = catalog.catalognodename.gsub(/\//, ' / ')
          %span.small
            (
            = catalog.catalognodeid
            )
      %td= catalog.created
      %td= catalog.updated
      - secure = SECURITY.select{|s| s[:level] == catalog.secure }.first[:name].downcase
      %td= secure
      %td= link_to 'Show', [:admin, catalog]
      %td
        = link_to_if can?(:update, catalog), 'Edit', edit_admin_catalog_path(catalog) do
          .unable Edit
      %td
        = link_to_if can?(:destroy, catalog), 'Destroy', admin_catalog_path(catalog), :confirm => 'Are you sure?', :method => :delete do
          .unable Destroy
%br
= paginate @catalogs
%br

%p
  = link_to_if can?(:create, Catalog), "New Catalog", new_admin_catalog_path do
    .unable New Catalog
